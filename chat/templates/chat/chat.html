<!DOCTYPE html>
{% extends "home/base.html" %}
{% load static %}
{% load i18n %}
{% load filters %}

{% block content %}

  <!-- Bootstrap JS -->
  <!-- <script src="{% static 'chat/js/bootstrap.min.js' %}" async></script> -->

  <!-- EJS template library -->
  <script src="{% static 'chat/js/ejs.min.js' %}"></script>

  <!-- Core CSS file -->
  <link rel="stylesheet" href="{% static 'chat/css/photoswipe/photoswipe.css' %}">

  <!-- Skin CSS file (styling of UI - buttons, caption, etc.)
     In the folder of skin CSS file there are also:
     - .png and .svg icons sprite,
     - preloader.gif (for browsers that do not support CSS animations) -->
  <link rel="stylesheet" href="{% static 'chat/css/photoswipe/default-skin.css' %}">

  <!-- Core JS file -->
  <script src="{% static 'chat/js/photoswipe/photoswipe.min.js' %}"></script>

  <!-- UI JS file -->
  <script src="{% static 'chat/js/photoswipe/photoswipe-ui-default.min.js' %}"></script>

  <!-- Room Header -->
  <div class="row">
    <div class="room-header">
    </div>
  </div>
  <!-- End Room Header -->

<!-- ------------------------------------------------------------------------ -->

  <!-- Archive -->
  <script>
    $(document).ready(function(){
      $("#toggleButton").click(function(){
        $("#content").slideToggle(100);
      });
    });
  </script>

  <style>
    #content {
      display: none; /* Initially hidden */
    }
  </style>
  <!-- Archive -->

  <!-- Archive -->
  <script>
    $(document).ready(function(){
      $("#toggleButton1").click(function(){
        $("#content1").slideToggle(100);
      });
    });
  </script>

  <style>
    #content1 {
      display: none; /* Initially hidden */
    }
  </style>
  <!-- Archive -->
  
<!-- ------------------------------------------------------------------------ -->

<div class="chat-wrapper class="col-md-12">

  <!-- Messages and Input field -->
  <div id="chats" class="col-md-7">

    <!-- Chat room -->
    <div class='room'>

      <!-- Messages -->
      <div class='messages text-center'>
        <p class="empty-chat-message">{% trans "Loading..." %}</p>
      </div>

      <!-- Chat controls: picture, text input, send button -->
      <div class='chat-controls'>
        <div class='image-preview-container' style='display:none'>
          <div class='preview-images'></div>
          <div class='delete-images-preview'>
            <i class='fas fa fa-times'></i>
          </div>
        </div>
        <div class='chat-controls-row'>
          <input type="file" id="file-input" class="file-input" multiple accept="image/*" style="display:none">
          <label for="file-input" class="chat-control btn" style="margin-bottom:0; cursor:pointer;">
            <i class="fas fa-paperclip"></i>
          </label>
          <input class='message-input'>
          <button class='send-message chat-control btn'><i class="fas fa-paper-plane"></i></button>
        </div>
      </div>

    </div>
  </div>

  <!-- Room list -->
  <div id="div-room-list" class="col-md-5">

    <div class="row">
      <div class="col">

        <p class="mb-1 text-muted">
          {% trans "Rooms" %}
          <a class="btn text-muted" href="{% url 'chat:add_room' %}">
            <i class="fas fa-plus"></i>
          </a>
          <i class="fas fa-info-circle" data-toggle="tooltip" data-placement="left" title="{% trans 'Public chat rooms are archived if they are not used for' %} {{ ARCHIVE_PUBLIC_CHAT_ROOM }} {% trans 'days. After' %} {{ DELETE_PUBLIC_CHAT_ROOM }} {% trans 'days they are deleted. Private messages are archived when user is blocked and deleted after' %} {{ DELETE_PUBLIC_CHAT_ROOM }} {% trans 'days' %}."></i>
        </p>

        <!-- Public active -->
        <div class="list-of-chats">
          {% for room in public_active %}
            {% include 'chat/room_icon.html' %}
          {% empty %}
            <p class="text-muted text-center">{% trans "None" %}</p>
          {% endfor %}
        </div>

        <!-- Public archived -->
        <p class="mt-0 mb-0">
          <button class="btn text-muted" id="toggleButton">{% trans "Archived" %}</button>
        </p>
        <div id="content">
          <div class="list-of-chats">
            {% for room in public_archived %}
              {% include 'chat/room_icon.html' %}
            {% empty %}
              <p class="text-muted text-center">{% trans "None" %}</p>
            {% endfor %}
          </div>
        </div>

      </div>
    </div>

    <!-- Private -->
    <div class="row">
      <div class="col">

        <!-- Private active -->
        <p class="mt-3 mb-1 text-muted">{% trans "Private Messages" %}</p>
        <div class="list-of-pms">
          {% for room in private_active %}
            {% include 'chat/room_icon.html' %}
          {% empty %}
            <p class="text-muted text-center">{% trans "None" %}</p>
          {% endfor %}
        </div>

        <!-- Private archived -->
        <p class="mt-0 mb-0">
          <button class="btn text-muted" id="toggleButton1">{% trans "Archived" %}</button>
        </p>
        <div id="content1">
          <div class="list-of-pms">
            {% for room in private_archived %}
              {% include 'chat/room_icon.html' %}
            {% empty %}
              <p class="text-muted text-center">{% trans "None" %}</p>
            {% endfor %}
          </div>
        </div>

      </div>
    </div>

  </div>
</div>

<!-- ------------------------------------------------------------------------------------------- -->

  <!-- Bootstrap modal for changes history -->
  <div id="message-history-modal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">{% trans "Changes history" %}</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label={% trans "Close" %}>
            <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">{% trans "Close" %}</button>
          </div>
        </div>
    </div>
   </div>
  <!-- End Modal -->

  <!-- Bootstrap modal for changes history -->
  <div id="message-permission-modal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">{% trans "Permission" %}</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label={% trans "Close" %}>
            <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
          </div>
        </div>
    </div>
   </div>
  <!-- End Modal -->

  <!-- Root element of PhotoSwipe. Must have class pswp. -->
  <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
       It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

      <!-- Container that holds slides.
        PhotoSwipe keeps only 3 of them in the DOM to save memory.
        Don't modify these 3 pswp__item elements, data is added later on. -->
      <div class="pswp__container">
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
        <div class="pswp__item"></div>
      </div>

      <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
      <div class="pswp__ui pswp__ui--hidden">

        <div class="pswp__top-bar">

          <!--  Controls are self-explanatory. Order can be changed. -->
          <div class="pswp__counter"></div>
          <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
          <button class="pswp__button pswp__button--share" title="Share"></button>
          <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
          <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

          <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
          <!-- element will get class pswp__preloader--active when preloader is running -->
          <div class="pswp__preloader">
            <div class="pswp__preloader__icn">
              <div class="pswp__preloader__cut">
              <div class="pswp__preloader__donut"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
          <div class="pswp__share-tooltip"></div>
        </div>

        <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
        </button>

        <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
        </button>

        <div class="pswp__caption">
          <div class="pswp__caption__center"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const LAST_USED_ROOM_ID = {{ last_used_room|default:"null"|safe }};
    const TRANSLATIONS = {{ translations|default:"{}"|safe }};
  </script>

{% endblock content %}

{% block extra_body %}
  <script type="module" src="{% static 'chat/js/chat.js' %}"></script>
{% endblock extra_body %}

{% block notifications_script %}
  <!-- Ignore notifications script as it is part of chat script already -->
{% endblock notifications_script %}
