{% extends "home/base.html" %}
{% load i18n %}
{% load bootstrap4 %}

{% block content %}
<div class="row">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>{{ event.title }}</h2>
            {% if user.is_authenticated %}
                <div>
                    <a href="{% url 'events:edit' event.pk %}" class="btn btn-secondary">
                        <i class="fas fa-edit"></i> {% trans "Edit" %}
                    </a>
                    <a href="{% url 'events:delete' event.pk %}" class="btn btn-danger">
                        <i class="fas fa-trash"></i> {% trans "Delete" %}
                    </a>
                </div>
            {% endif %}
        </div>

        <div class="card">
            <div class="card-body">
                {% if event.description %}
                    <div class="mb-4">
                        <h5>{% trans "Agenda" %}</h5>
                        <p>{{ event.description|urlize|linebreaks }}</p>
                    </div>
                {% endif %}

                {% if event.link or event.place %}
                    <div class="mb-4">
                        {% if event.link %}
                            <div class="mb-2">
                                <h6>{% trans "Link do spotkania" %}</h6>
                                <p><a href="{{ event.link }}" target="_blank" rel="noopener">{{ event.link }}</a> <i class="fas fa-external-link-alt fa-sm"></i></p>
                            </div>
                        {% endif %}
                        {% if event.place %}
                            <div class="mb-2">
                                <h6>{% trans "Place" %}</h6>
                                <p><i class="fas fa-map-marker-alt"></i> {{ event.place }}</p>
                            </div>
                        {% endif %}
                    </div>
                {% endif %}

                <div class="row">
                    <div class="col-md-6">
                        <h6>{% trans "Start Date" %}</h6>
                        <p><i class="fas fa-calendar"></i> {{ event.start_date|date:"l, Y-m-d H:i" }}</p>
                    </div>
                    {% if event.end_date %}
                        <div class="col-md-6">
                            <h6>{% trans "End Date" %}</h6>
                            <p><i class="fas fa-calendar"></i> {{ event.end_date|date:"l, Y-m-d H:i" }}</p>
                        </div>
                    {% endif %}
                </div>

                <div class="row">
                    <div class="col-md-4">
                        <h6>{% trans "Frequency" %}</h6>
                        <span class="badge badge-{% if event.frequency == 'once' %}secondary{% else %}info{% endif %} badge-lg">
                            {{ event.get_frequency_display }}
                        </span>
                    </div>
                    <div class="col-md-4">
                        <h6>{% trans "Status" %}</h6>
                        {% if event.is_active %}
                            <span class="badge badge-success badge-lg">{% trans "Active" %}</span>
                        {% else %}
                            <span class="badge badge-secondary badge-lg">{% trans "Inactive" %}</span>
                        {% endif %}
                    </div>
                    <div class="col-md-4">
                        <h6>{% trans "Visibility" %}</h6>
                        {% if event.is_public %}
                            <span class="badge badge-primary badge-lg" title="{% trans 'Visible to everyone' %}">
                                <i class="fas fa-globe"></i> {% trans "Public" %}
                            </span>
                        {% else %}
                            <span class="badge badge-warning badge-lg" title="{% trans 'Visible only to logged-in users' %}">
                                <i class="fas fa-lock"></i> {% trans "Private" %}
                            </span>
                        {% endif %}
                    </div>
                </div>

                {% if event.frequency != 'once' and event.is_active %}
                    <div class="mt-4">
                        <h6>{% trans "Next Occurrence" %}</h6>
                        {% with next_occurrence=event.get_next_occurrence %}
                            {% if next_occurrence %}
                                <p class="text-success">
                                    <i class="fas fa-clock"></i> {{ next_occurrence|date:"l, Y-m-d H:i" }}
                                </p>
                            {% else %}
                                <p class="text-muted">{% trans "No upcoming occurrences" %}</p>
                            {% endif %}
                        {% endwith %}
                    </div>
                {% endif %}

                <div class="mt-4">
                    <small class="text-muted">
                        {% trans "Created" %}: {{ event.created_at|date:"Y-m-d H:i" }}
                        {% if event.updated_at != event.created_at %}
                            | {% trans "Updated" %}: {{ event.updated_at|date:"Y-m-d H:i" }}
                        {% endif %}
                    </small>
                </div>
            </div>
        </div>

        <div class="mt-3">
            <a href="{% url 'events:list' %}" class="btn btn-outline-primary">
                <i class="fas fa-arrow-left"></i> {% trans "Back to Calendar" %}
            </a>
        </div>
    </div>
</div>
{% endblock %}
